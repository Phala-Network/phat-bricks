(()=>{"use strict";var t={730:(t,e)=>{}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var s=e[n]={exports:{}};return t[n](s,s.exports,r),s.exports}(()=>{function t(t,e,r){const n=e.split("|").map((t=>t.trim()));for(let r=0;r<n.length;r++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof t===e)return}const i=new Error(`invalid value for type ${e}`);throw i.code="INVALID_ARGUMENT",i.argument=`value.${r}`,i.value=t,i}function e(e,r,n){for(let i in r){let s=r[i];const a=n?n[i]:null;a&&t(s,a,i),Object.defineProperty(e,i,{enumerable:!0,value:s,writable:!1})}}function n(t){if(null==t)return"null";if(Array.isArray(t))return"[ "+t.map(n).join(", ")+" ]";if(t instanceof Uint8Array){const e="0123456789abcdef";let r="0x";for(let n=0;n<t.length;n++)r+=e[t[n]>>4],r+=e[15&t[n]];return r}if("object"==typeof t&&"function"==typeof t.toJSON)return n(t.toJSON());switch(typeof t){case"boolean":case"symbol":case"number":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const e=Object.keys(t);return e.sort(),"{ "+e.map((e=>`${n(e)}: ${n(t[e])}`)).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function i(t,e){return t&&t.code===e}function s(t,r,i,s){if(!t)throw function(t,r,i){{const e=[];if(i){if("message"in i||"code"in i||"name"in i)throw new Error(`value will overwrite populated values: ${n(i)}`);for(const t in i){const r=i[t];e.push(t+"="+n(r))}}e.push(`code=${r}`),e.push("version=6.6.3"),e.length&&(t+=" ("+e.join(", ")+")")}let s;switch(r){case"INVALID_ARGUMENT":s=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(t);break;default:s=new Error(t)}return e(s,{code:r}),i&&Object.assign(s,i),s}(r,i,s)}function a(t,e,r,n){s(t,e,"INVALID_ARGUMENT",{argument:r,value:n})}r(730),["NFD","NFC","NFKD","NFKC"].reduce(((t,e)=>{try{if("test"!=="test".normalize(e))throw new Error("bad");if("NFD"===e){if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken")}t.push(e)}catch(t){}return t}),[]);const o=BigInt(0),u=BigInt(1),c=9007199254740991;function l(t,e){const r=h(t,"value"),n=BigInt(p(e,"bits"));return r&(u<<n)-u}function f(t,e){switch(typeof t){case"bigint":return t;case"number":return a(Number.isInteger(t),"underflow",e||"value",t),a(t>=-c&&t<=c,"overflow",e||"value",t),BigInt(t);case"string":try{if(""===t)throw new Error("empty string");return"-"===t[0]&&"-"!==t[1]?-BigInt(t.substring(1)):BigInt(t)}catch(r){a(!1,`invalid BigNumberish string: ${r.message}`,e||"value",t)}}a(!1,"invalid BigNumberish value",e||"value",t)}function h(t,e){const r=f(t,e);return s(r>=o,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),r}const d="0123456789abcdef";function g(t){if(t instanceof Uint8Array){let e="0x0";for(const r of t)e+=d[r>>4],e+=d[15&r];return BigInt(e)}return f(t)}function p(t,e){switch(typeof t){case"bigint":return a(t>=-c&&t<=c,"overflow",e||"value",t),Number(t);case"number":return a(Number.isInteger(t),"underflow",e||"value",t),a(t>=-c&&t<=c,"overflow",e||"value",t),t;case"string":try{if(""===t)throw new Error("empty string");return p(BigInt(t),e)}catch(r){a(!1,`invalid numeric string: ${r.message}`,e||"value",t)}}a(!1,"invalid numeric value",e||"value",t)}const y={};function w(t,e){let r=!1;return e<0&&(r=!0,e*=-1),new v(y,`${r?"":"u"}int${e}`,t,{signed:r,width:e})}function b(t,e){return new v(y,`bytes${e||""}`,t,{size:e})}const m=Symbol.for("_ethers_typed");class v{type;value;#t;_typedSymbol;constructor(t,r,n,i){null==i&&(i=null),function(t,e,r){if(null==r&&(r=""),t!==e){let t=r,e="new";r&&(t+=".",e+=" "+r),s(!1,`private constructor; use ${t}from* methods`,"UNSUPPORTED_OPERATION",{operation:e})}}(y,t,"Typed"),e(this,{_typedSymbol:m,type:r,value:n}),this.#t=i,this.format()}format(){if("array"===this.type)throw new Error("");if("dynamicArray"===this.type)throw new Error("");return"tuple"===this.type?`tuple(${this.value.map((t=>t.format())).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return"string"===this.type}get tupleName(){if("tuple"!==this.type)throw TypeError("not a tuple");return this.#t}get arrayLength(){if("array"!==this.type)throw TypeError("not an array");return!0===this.#t?-1:!1===this.#t?this.value.length:null}static from(t,e){return new v(y,t,e)}static uint8(t){return w(t,8)}static uint16(t){return w(t,16)}static uint24(t){return w(t,24)}static uint32(t){return w(t,32)}static uint40(t){return w(t,40)}static uint48(t){return w(t,48)}static uint56(t){return w(t,56)}static uint64(t){return w(t,64)}static uint72(t){return w(t,72)}static uint80(t){return w(t,80)}static uint88(t){return w(t,88)}static uint96(t){return w(t,96)}static uint104(t){return w(t,104)}static uint112(t){return w(t,112)}static uint120(t){return w(t,120)}static uint128(t){return w(t,128)}static uint136(t){return w(t,136)}static uint144(t){return w(t,144)}static uint152(t){return w(t,152)}static uint160(t){return w(t,160)}static uint168(t){return w(t,168)}static uint176(t){return w(t,176)}static uint184(t){return w(t,184)}static uint192(t){return w(t,192)}static uint200(t){return w(t,200)}static uint208(t){return w(t,208)}static uint216(t){return w(t,216)}static uint224(t){return w(t,224)}static uint232(t){return w(t,232)}static uint240(t){return w(t,240)}static uint248(t){return w(t,248)}static uint256(t){return w(t,256)}static uint(t){return w(t,256)}static int8(t){return w(t,-8)}static int16(t){return w(t,-16)}static int24(t){return w(t,-24)}static int32(t){return w(t,-32)}static int40(t){return w(t,-40)}static int48(t){return w(t,-48)}static int56(t){return w(t,-56)}static int64(t){return w(t,-64)}static int72(t){return w(t,-72)}static int80(t){return w(t,-80)}static int88(t){return w(t,-88)}static int96(t){return w(t,-96)}static int104(t){return w(t,-104)}static int112(t){return w(t,-112)}static int120(t){return w(t,-120)}static int128(t){return w(t,-128)}static int136(t){return w(t,-136)}static int144(t){return w(t,-144)}static int152(t){return w(t,-152)}static int160(t){return w(t,-160)}static int168(t){return w(t,-168)}static int176(t){return w(t,-176)}static int184(t){return w(t,-184)}static int192(t){return w(t,-192)}static int200(t){return w(t,-200)}static int208(t){return w(t,-208)}static int216(t){return w(t,-216)}static int224(t){return w(t,-224)}static int232(t){return w(t,-232)}static int240(t){return w(t,-240)}static int248(t){return w(t,-248)}static int256(t){return w(t,-256)}static int(t){return w(t,-256)}static bytes1(t){return b(t,1)}static bytes2(t){return b(t,2)}static bytes3(t){return b(t,3)}static bytes4(t){return b(t,4)}static bytes5(t){return b(t,5)}static bytes6(t){return b(t,6)}static bytes7(t){return b(t,7)}static bytes8(t){return b(t,8)}static bytes9(t){return b(t,9)}static bytes10(t){return b(t,10)}static bytes11(t){return b(t,11)}static bytes12(t){return b(t,12)}static bytes13(t){return b(t,13)}static bytes14(t){return b(t,14)}static bytes15(t){return b(t,15)}static bytes16(t){return b(t,16)}static bytes17(t){return b(t,17)}static bytes18(t){return b(t,18)}static bytes19(t){return b(t,19)}static bytes20(t){return b(t,20)}static bytes21(t){return b(t,21)}static bytes22(t){return b(t,22)}static bytes23(t){return b(t,23)}static bytes24(t){return b(t,24)}static bytes25(t){return b(t,25)}static bytes26(t){return b(t,26)}static bytes27(t){return b(t,27)}static bytes28(t){return b(t,28)}static bytes29(t){return b(t,29)}static bytes30(t){return b(t,30)}static bytes31(t){return b(t,31)}static bytes32(t){return b(t,32)}static address(t){return new v(y,"address",t)}static bool(t){return new v(y,"bool",!!t)}static bytes(t){return new v(y,"bytes",t)}static string(t){return new v(y,"string",t)}static array(t,e){throw new Error("not implemented yet")}static tuple(t,e){throw new Error("not implemented yet")}static overrides(t){return new v(y,"overrides",Object.assign({},t))}static isTyped(t){return t&&"object"==typeof t&&"_typedSymbol"in t&&t._typedSymbol===m}static dereference(t,e){if(v.isTyped(t)){if(t.type!==e)throw new Error(`invalid type: expecetd ${e}, got ${t.type}`);return t.value}return t}}function E(t,e,r){if(t instanceof Uint8Array)return r?new Uint8Array(t):t;if("string"==typeof t&&t.match(/^0x([0-9a-f][0-9a-f])*$/i)){const e=new Uint8Array((t.length-2)/2);let r=2;for(let n=0;n<e.length;n++)e[n]=parseInt(t.substring(r,r+2),16),r+=2;return e}a(!1,"invalid BytesLike value",e||"value",t)}function N(t,e){return E(t,e,!0)}const I="0123456789abcdef";function U(t){const e=E(t,r,!1);var r;let n="0x";for(let t=0;t<e.length;t++){const r=e[t];n+=I[(240&r)>>4]+I[15&r]}return n}function R(t){return"0x"+t.map((t=>U(t).substring(2))).join("")}const A=32,T=new Uint8Array(A),F=["then"],x={};function B(t,e){const r=new Error(`deferred error during ABI decoding triggered accessing ${t}`);throw r.error=e,r}class O extends Array{#e;constructor(...t){const e=t[0];let r=t[1],n=(t[2]||[]).slice(),i=!0;e!==x&&(r=t,n=[],i=!1),super(r.length),r.forEach(((t,e)=>{this[e]=t}));const s=n.reduce(((t,e)=>("string"==typeof e&&t.set(e,(t.get(e)||0)+1),t)),new Map);if(this.#e=Object.freeze(r.map(((t,e)=>{const r=n[e];return null!=r&&1===s.get(r)?r:null}))),i)return Object.freeze(this),new Proxy(this,{get:(t,e,r)=>{if("string"==typeof e){if(e.match(/^[0-9]+$/)){const r=p(e,"%index");if(r<0||r>=this.length)throw new RangeError("out of result range");const n=t[r];return n instanceof Error&&B(`index ${r}`,n),n}if(F.indexOf(e)>=0)return Reflect.get(t,e,r);const n=t[e];if(n instanceof Function)return function(...e){return n.apply(this===r?t:this,e)};if(!(e in t))return t.getValue.apply(this===r?t:this,[e])}return Reflect.get(t,e,r)}})}toArray(){const t=[];return this.forEach(((e,r)=>{e instanceof Error&&B(`index ${r}`,e),t.push(e)})),t}toObject(){return this.#e.reduce(((t,e,r)=>(s(null!=e,"value at index ${ index } unnamed","UNSUPPORTED_OPERATION",{operation:"toObject()"}),e in t||(t[e]=this.getValue(e)),t)),{})}slice(t,e){null==t&&(t=0),t<0&&(t+=this.length)<0&&(t=0),null==e&&(e=this.length),e<0&&(e+=this.length)<0&&(e=0),e>this.length&&(e=this.length);const r=[],n=[];for(let i=t;i<e;i++)r.push(this[i]),n.push(this.#e[i]);return new O(x,r,n)}filter(t,e){const r=[],n=[];for(let i=0;i<this.length;i++){const s=this[i];s instanceof Error&&B(`index ${i}`,s),t.call(e,s,i,this)&&(r.push(s),n.push(this.#e[i]))}return new O(x,r,n)}map(t,e){const r=[];for(let n=0;n<this.length;n++){const i=this[n];i instanceof Error&&B(`index ${n}`,i),r.push(t.call(e,i,n,this))}return r}getValue(t){const e=this.#e.indexOf(t);if(-1===e)return;const r=this[e];return r instanceof Error&&B(`property ${JSON.stringify(t)}`,r.error),r}static fromItems(t,e){return new O(x,t,e)}}function $(t){let e=function(t){const e=h(t,"value");if(e===o)return new Uint8Array([]);let r=e.toString(16);r.length%2&&(r="0"+r);const n=new Uint8Array(r.length/2);for(let t=0;t<n.length;t++){const e=2*t;n[t]=parseInt(r.substring(e,e+2),16)}return n}(t);return s(e.length<=A,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:A,offset:e.length}),e.length!==A&&(e=N(R([T.slice(e.length%A),e]))),e}class L{name;type;localName;dynamic;constructor(t,r,n,i){e(this,{name:t,type:r,localName:n,dynamic:i},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(t,e){a(!1,t,this.localName,e)}}class _{#r;#n;constructor(){this.#r=[],this.#n=0}get data(){return R(this.#r)}get length(){return this.#n}#i(t){return this.#r.push(t),this.#n+=t.length,t.length}appendWriter(t){return this.#i(N(t.data))}writeBytes(t){let e=N(t);const r=e.length%A;return r&&(e=N(R([e,T.slice(r)]))),this.#i(e)}writeValue(t){return this.#i($(t))}writeUpdatableValue(){const t=this.#r.length;return this.#r.push(T),this.#n+=A,e=>{this.#r[t]=$(e)}}}class D{allowLoose;#r;#s;constructor(t,r){e(this,{allowLoose:!!r}),this.#r=N(t),this.#s=0}get data(){return U(this.#r)}get dataLength(){return this.#r.length}get consumed(){return this.#s}get bytes(){return new Uint8Array(this.#r)}#a(t,e,r){let n=Math.ceil(e/A)*A;return this.#s+n>this.#r.length&&(this.allowLoose&&r&&this.#s+e<=this.#r.length?n=e:s(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:N(this.#r),length:this.#r.length,offset:this.#s+n})),this.#r.slice(this.#s,this.#s+n)}subReader(t){return new D(this.#r.slice(this.#s+t),this.allowLoose)}readBytes(t,e){let r=this.#a(0,t,!!e);return this.#s+=r.length,r.slice(0,t)}readValue(){return g(this.readBytes(A))}readIndex(){return p(g(this.readBytes(A)))}}const V=BigInt(0),j=BigInt(1),S=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class C extends L{constructor(t,e){super(t,t,e,!0)}defaultValue(){return"0x"}encode(t,e){e=N(e);let r=t.writeValue(e.length);return r+=t.writeBytes(e),r}decode(t){return t.readBytes(t.readIndex(),!0)}}class M extends L{coders;constructor(t,r){let n=!1;const i=[];t.forEach((t=>{t.dynamic&&(n=!0),i.push(t.type)})),super("tuple","tuple("+i.join(",")+")",r,n),e(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach((e=>{t.push(e.defaultValue())}));const e=this.coders.reduce(((t,e)=>{const r=e.localName;return r&&(t[r]||(t[r]=0),t[r]++),t}),{});return this.coders.forEach(((r,n)=>{let i=r.localName;i&&1===e[i]&&("length"===i&&(i="_length"),null==t[i]&&(t[i]=t[n]))})),Object.freeze(t)}encode(t,e){const r=v.dereference(e,"tuple");return function(t,e,r){let n=[];if(Array.isArray(r))n=r;else if(r&&"object"==typeof r){let t={};n=e.map((e=>{const n=e.localName;return s(n,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:e},value:r}),s(!t[n],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:e},value:r}),t[n]=!0,r[n]}))}else a(!1,"invalid tuple value","tuple",r);a(e.length===n.length,"types/value length mismatch","tuple",r);let i=new _,o=new _,u=[];e.forEach(((t,e)=>{let r=n[e];if(t.dynamic){let e=o.length;t.encode(o,r);let n=i.writeUpdatableValue();u.push((t=>{n(t+e)}))}else t.encode(i,r)})),u.forEach((t=>{t(i.length)}));let c=t.appendWriter(i);return c+=t.appendWriter(o),c}(t,this.coders,r)}decode(t){return function(t,e){let r=[],n=[],s=t.subReader(0);return e.forEach((e=>{let a=null;if(e.dynamic){let r=t.readIndex(),n=s.subReader(r);try{a=e.decode(n)}catch(t){if(i(t,"BUFFER_OVERRUN"))throw t;a=t,a.baseType=e.name,a.name=e.localName,a.type=e.type}}else try{a=e.decode(t)}catch(t){if(i(t,"BUFFER_OVERRUN"))throw t;a=t,a.baseType=e.name,a.name=e.localName,a.type=e.type}if(null==a)throw new Error("investigate");r.push(a),n.push(e.localName||null)})),O.fromItems(r,n)}(t,this.coders)}}void 0===globalThis.scriptArgs&&(globalThis.scriptArgs=["0x00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000043078303100000000000000000000000000000000000000000000000000000000","https://api-v2-mumbai-live.lens.dev"]);const P=new class extends L{size;signed;constructor(t,r,n){const i=(r?"int":"uint")+8*t;super(i,i,n,!1),e(this,{size:t,signed:r},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,e){let r=f(v.dereference(e,this.type)),n=l(S,256);if(this.signed){let t=l(n,8*this.size-1);(r>t||r<-(t+j))&&this._throwError("value out-of-bounds",e),r=function(t,e){let r=f(t,"value");const n=BigInt(p(256,"width")),i=u<<n-u;return r<o?(r=-r,s(r<=i,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t}),(~r&(u<<n)-u)+u):(s(r<i,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t}),r)}(r)}else(r<V||r>l(n,8*this.size))&&this._throwError("value out-of-bounds",e);return t.writeValue(r)}decode(t){let e=l(t.readValue(),8*this.size);return this.signed&&(e=function(t,e){const r=h(t,"value"),n=BigInt(p(e,"width"));return s(r>>n===o,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:t}),r>>n-u?-((~r&(u<<n)-u)+u):r}(e,8*this.size)),e}}(32,!1,"uint256"),z=new class extends C{constructor(t){super("bytes",t)}decode(t){return U(super.decode(t))}}("bytes");function q(t){return function(t,e){const r=new M(t,"_"),n=new _;return r.encode(n,e),n.data}([P,P,P],t)}var k;function J(t){switch(t){case k.BadLensProfileId:return 1;case k.FailedToFetchData:return 2;case k.FailedToDecode:return 3;case k.MalformedRequest:return 4;default:return 0}}function G(t,e){return q([2,t,J(e)])}function W(t){console.log(`Reply: ${t}`),globalThis.scriptOutput=t}!function(t){t.BadLensProfileId="BadLensProfileId",t.FailedToFetchData="FailedToFetchData",t.FailedToDecode="FailedToDecode",t.MalformedRequest="MalformedRequest"}(k||(k={})),async function(t,e){let r;console.log(`handle req: ${t}`);try{n=t,r=new M([P,z],"_").decode(new D(n,void 0))}catch(t){return console.info("Malformed request received"),G(0,t)}var n;console.log(`Decoded request: ${r}`);const i=r[0],s=function(t){var e=t.toString();if(!function(t){return/^0x[0-9a-f]+$/.test(t.toLowerCase())}(e))throw k.BadLensProfileId;e=e.slice(2);for(var r="",n=0;n<e.length;n+=2)r+=String.fromCharCode(parseInt(e.substr(n,2),16));return r}(r[1]);console.log(`Request received for profile ${s}`);try{const t=await async function(t,e){const r=JSON.stringify({query:`query Profile {\n            profile(request: { forProfileId: "${e}" }) {\n                stats {\n                    followers\n                    posts\n                    comments\n                    mirrors\n                    publications\n                }\n            }\n        }`}),n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json","User-Agent":"phat-contract"},body:r});if(200!=n.status){let t=await n.text();throw console.log(`Fail to read Lens api with status code: ${n.status}, body: ${t}`),k.FailedToFetchData}let i=await n.text();if("string"!=typeof i)throw k.FailedToDecode;return JSON.parse(i)}(e,s);let r=t.data.profile.stats.posts;return console.log("response:",[0,i,r]),q([0,i,r])}catch(t){if(t===k.FailedToFetchData)throw t;return console.log("error:",[2,i,t]),G(i,t)}}(scriptArgs[0],scriptArgs[1]).then(W).catch(W).finally(process.exit)})()})();